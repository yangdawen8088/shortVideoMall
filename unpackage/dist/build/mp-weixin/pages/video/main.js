(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/video/main"],{"0659":function(t,e,i){"use strict";i.r(e);var s=i("1ee6"),o=i.n(s);for(var a in s)"default"!==a&&function(t){i.d(e,t,function(){return s[t]})}(a);e["default"]=o.a},"1ee6":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={data:function(){return{system:this.systemInfo(),videolist:[],clientHeight:"0",currentPage:0,showPage:0,nextPage:0,touchdata:{can:!0,startY:0,endY:0,diff:0},playIndex:-1,scrollTop:0,scrollToView:"view-0",showCover:!0,animationData:{},playTime:0,scrollDetail:{deltaY:0},scrollFlag:!1,scrollStartTop:0,pageSize:20,pageIndex:0,scene:"",showTab:!0}},mounted:function(){var e=this;t.getSystemInfo({success:function(t){console.log(t.model),console.log(t.pixelRatio),console.log(t.windowWidth),console.log(t.windowHeight),console.log(t.language),console.log(t.version),console.log(t.platform),e.$data.clientHeight=t.windowHeight}})},watch:{},onShareAppMessage:function(t){var e=this.videolist[this.currentPage],i="「好物短视频」"+e.video_desc;return{title:i,path:"/pages/video/main?scene="+e.id}},onLoad:function(e){var i=this;if(t.showShareMenu({}),e.scene&&"default"!=e.scene){this.scene=e.scene;var s=e.scene;this.postJson({path:"/video_one.jsp",data:{videoId:s},success:function(t){if("ok"==t.data.status){var e=t.data.data;i.videolist=e.concat(i.videolist);e[0]}}})}this.postJson({path:"/video_main.jsp",data:{pageIndex:this.pageIndex,pageSize:this.pageSize,type:1},success:function(t){if(console.log(t.data),"ok"==t.data.status){i.pageIndex++;var e=t.data.data;i.videolist=i.videolist.concat(e)}}}),setInterval(this.listenScroll,200)},methods:{download:function(t){},refresh:function(){var e=this;this.play(-1),t.showLoading({title:"加载中"}),this.videolist=[],this.pageIndex=0,this.postJson({path:"/video_main.jsp",data:{pageIndex:this.pageIndex,pageSize:this.pageSize,type:1},success:function(t){console.log(t.data),"ok"==t.data.status&&(e.pageIndex++,e.videolist=t.data.data,e.currentPage=0,e.scrollToView="view-0")},complete:function(){t.hideLoading()}})},scrolltolower:function(){var t=this;this.postJson({path:"/video_main.jsp",data:{pageIndex:this.pageIndex,pageSize:this.pageSize,type:1},success:function(e){if(console.log(e.data),"ok"==e.data.status){t.pageIndex++;var i=e.data.data;t.videolist=t.videolist.concat(i)}}})},play:function(e){var i="video-"+e,s="video-"+this.playIndex;if(-1==this.playIndex){this.playIndex=e;var o=t.createVideoContext(i);o&&(o.play(),this.playTime=(new Date).getTime())}else{var a=t.createVideoContext(s);if(a){a.pause();var l={playTime:this.playTime,endTime:(new Date).getTime(),videoId:this.videolist[this.playIndex].id,videoUid:this.videolist[this.playIndex].uid};this.browser(l),e!=this.playIndex?(this.playIndex=e,a=t.createVideoContext(i),a&&(a.play(),this.playTime=(new Date).getTime())):this.playIndex=-1}}},pause:function(e){var i="video-"+e,s=t.createVideoContext(i);if(s){s.pause();var o={playTime:this.playTime,endTime:(new Date).getTime(),videoId:this.videolist[e].id,videoUid:this.videolist[e].uid};this.browser(o)}this.playIndex=-1},browser:function(t){t.playTime<=0||(this.playTime=0,this.postJson({path:"/video_browser_do.jsp",data:t,success:function(t){}}))},listenScroll:function(){0!=this.scrollDetail.deltaY?(this.scrollFlag||(this.scrollStart(),this.scrollFlag=!0,this.scrollStartTop=this.scrollDetail.scrollTop),this.scrollDetail.deltaY=0):this.scrollFlag&&(this.scrollEnd(),this.scrollFlag=!1)},scrollStart:function(){},scrollEnd:function(){var t=this;if(!(this.autoScrollFlag-- >0)){var e=this.scrollDetail.scrollTop-this.scrollStartTop;console.log("clientHeight="+this.clientHeight+",scrollTop="+this.scrollDetail.scrollTop+",diff="+e),e<0?(console.log("this.touchdata.diff>0"),this.scrollDetail.scrollTop%this.clientHeight<this.clientHeight-10?(console.log("e.detail.scrollTop%this.clientHeight < this.clientHeight*3/4"),this.nextPage=Math.floor(this.scrollDetail.scrollTop/this.clientHeight)):this.nextPage=Math.floor(this.scrollDetail.scrollTop/this.clientHeight+1)):this.scrollDetail.scrollTop%this.clientHeight>=10?this.nextPage=Math.floor(this.scrollDetail.scrollTop/this.clientHeight+1):this.nextPage=Math.floor(this.scrollDetail.scrollTop/this.clientHeight),this.nextPage>=this.videolist.length&&(this.nextPage=this.videolist.length-1),this.nextPage<0&&(this.nextPage=0),this.scrollToView="view-"+this.nextPage,this.autoScrollFlag=1,setTimeout(function(){t.scrollToView=""},300),this.currentPage!=this.nextPage&&setTimeout(function(){t.currentPage=t.nextPage,t.play(t.currentPage),t.showCover=!0},700)}},scroll:function(t){var e=this;this.showCover=!1,this.scrollDetail=t.detail,setTimeout(function(){e.playIndex},100)},scrollTo:function(t){this.play(t)},scrollMove:function(t){},touchStart:function(t){var e=t.touches[0];this.touchdata.startY=e.pageY,console.log("y="+this.touchdata.startY),this.inDown=-1,this.outTop=-1,this.inTop=-1,this.outDown=-1,this.touchdata.diff=0},touchMove:function(t){var e=t.touches[0],i=e.pageY;this.touchdata.diff=i-this.touchdata.startY,console.log("currentPage="+this.currentPage+",nextPage="+this.nextPage+",diff="+this.touchdata.diff+",y="+i+",startY="+this.touchdata.startY)},touchEnd:function(t){var e=this,i=this.scrollDetail.scrollTop-this.scrollStartTop;if(this.scrollDetail.scrollTop&&!(i>-1&&i<1)){console.log("clientHeight="+this.clientHeight+",scrollTop="+this.scrollDetail.scrollTop+",diff="+i),i<0?(console.log("this.touchdata.diff>0"),this.scrollDetail.scrollTop%this.clientHeight<this.clientHeight-10?(console.log("e.detail.scrollTop%this.clientHeight < this.clientHeight*3/4"),this.nextPage=Math.floor(this.scrollDetail.scrollTop/this.clientHeight)):this.nextPage=Math.floor(this.scrollDetail.scrollTop/this.clientHeight+1)):this.scrollDetail.scrollTop%this.clientHeight>=10?this.nextPage=Math.floor(this.scrollDetail.scrollTop/this.clientHeight+1):this.nextPage=Math.floor(this.scrollDetail.scrollTop/this.clientHeight),this.nextPage>=this.videolist.length&&(this.nextPage=this.videolist.length-1),this.nextPage<0&&(this.nextPage=0);this.touchdata.diff=0,this.scrollToView="view-"+this.nextPage,this.autoScrollFlag=2,setTimeout(function(){e.scrollToView=""},500),this.currentPage!=this.nextPage&&setTimeout(function(){e.currentPage=e.nextPage,e.play(e.currentPage),e.showCover=!0},700)}},like:function(e){var i=e.currentTarget.dataset.index;if(this.getUserInfo()){var s=this.videolist[i],o=null==s.favorId;s.favorId=!!o||null,s.favorite_num=o?s.favorite_num+1:s.favorite_num-1,this.postJson({path:"/video_favorite_do.jsp",data:{videoId:s.id,videoUid:s.uid,isLike:o},success:function(t){}})}else t.showToast({icon:"none",title:"请先登录"})},touchCacel:function(t){this.touchEnd(t)},close:function(t){this.showTab=!1}}};e.default=i}).call(this,i("543d")["default"])},"3d91":function(t,e,i){"use strict";var s=i("de1b"),o=i.n(s);o.a},"5b3f":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"content",style:{height:t.clientHeight+"px"}},[i("scroll-view",{staticClass:"scroll-content",style:{height:t.system.windowHeight+"px"},attrs:{"scroll-y":!0,"scroll-with-animation":!0,"upper-threshold":"-50","scroll-into-view":t.scrollToView,eventid:"62492f3c-3"},on:{scroll:t.scroll,scrolltolower:t.scrolltolower,scrolltoupper:t.refresh,touchstart:t.touchStart,touchmove:t.touchMove,touchend:t.touchEnd}},t._l(t.videolist,function(e,s){return i("view",{key:s,staticClass:"video-view",style:{height:t.system.windowHeight+"px"},attrs:{id:"view-"+s}},[s==t.currentPage?i("video",{style:{height:t.system.windowHeight-400*t.system.windowWidth/750+"px"},attrs:{id:"video-"+s,src:e.video_url,loop:"true",controls:!1,"show-progress":!1,"show-fullscreen-btn":!1,"show-play-btn":!1,"show-center-play-btn":!1,"enable-progress-gesture":!1,eventid:"62492f3c-0-"+s},on:{tap:function(e){t.play(t.currentPage)}}},[t.showCover?i("cover-image",{staticClass:"play_icon",style:{display:s!=t.playIndex?"block":"none"},attrs:{animation:t.animationData,src:"/static/img/play.png",mpcomid:"62492f3c-0-"+s}}):t._e()],1):t._e(),i("view",{staticClass:"goods padding"},[i("view",{staticClass:"title text-cut"},[t._v(t._s(e.goodstitle))]),i("view",{staticClass:"flex"},[i("view",{staticClass:"flex-sub"},[i("view",{staticClass:"seller"},[t._v(t._s(e.goodsnick)+" | "+t._s(e.goodsarea))]),i("view",{staticClass:"payinfo"},[i("text",{staticClass:"currency"},[t._v("¥")]),i("text",{staticClass:"price"},[t._v(t._s(e.goodsprice))]),i("text",{staticClass:"payernum"},[t._v(t._s(e.payer_num)+"人付款")])])]),i("view",{staticClass:"action flex flex-sub justify-end align-start"},[i("view",{staticClass:"favor",attrs:{"data-index":s,eventid:"62492f3c-1-"+s},on:{tap:t.like}},[i("image",{staticClass:"favor-img",attrs:{src:null!=e.favorId?"/static/img/favor.png":"/static/img/unlike.png"}}),i("view",{staticClass:"favor-num"},[t._v(t._s(e.favorite_num))])]),i("view",{staticClass:"share"},[i("image",{attrs:{src:"/static/img/share.png"}}),i("view",[t._v(t._s(e.share_num))])]),i("button",{staticClass:"cu-btn round bg-blue",attrs:{eventid:"62492f3c-2-"+s},on:{tap:function(i){t.toPage("/pages/goods/goods?goodsId="+e.goodsid)}}},[t._v("好物详情")])],1)]),i("view",{staticClass:"user flex justify-start align-end"},[i("image",{staticClass:"head-img",attrs:{src:e.head_img}}),i("view",{staticClass:"nickname"},[t._v(t._s(e.nick_name)+"  推荐")]),i("view",{staticClass:"location flex justify-start align-end"},[i("view",{staticClass:"cuIcon-locationfill location-icon"}),i("view",{staticClass:"location-name"},[t._v(t._s(e.location_name))])])]),i("view",{staticClass:"desc"},[t._v(t._s(e.video_desc))])])])}))],1)},o=[];i.d(e,"a",function(){return s}),i.d(e,"b",function(){return o})},c568:function(t,e,i){"use strict";i("719a");var s=a(i("b0ce")),o=a(i("de5c"));function a(t){return t&&t.__esModule?t:{default:t}}Page((0,s.default)(o.default))},de1b:function(t,e,i){},de5c:function(t,e,i){"use strict";i.r(e);var s=i("5b3f"),o=i("0659");for(var a in o)"default"!==a&&function(t){i.d(e,t,function(){return o[t]})}(a);i("3d91");var l=i("2877"),n=Object(l["a"])(o["default"],s["a"],s["b"],!1,null,null,null);e["default"]=n.exports}},[["c568","common/runtime","common/vendor"]]]);