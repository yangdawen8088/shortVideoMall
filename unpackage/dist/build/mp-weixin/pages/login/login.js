(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"0a63":function(t,e,o){"use strict";o.r(e);var n=o("f370"),i=o.n(n);for(var s in n)"default"!==s&&function(t){o.d(e,t,function(){return n[t]})}(s);e["default"]=i.a},"18ce":function(t,e,o){"use strict";o.r(e);var n=o("3886"),i=o("0a63");for(var s in i)"default"!==s&&function(t){o.d(e,t,function(){return i[t]})}(s);var a=o("2877"),c=Object(a["a"])(i["default"],n["a"],n["b"],!1,null,null,null);e["default"]=c.exports},3886:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("view",{staticClass:"bg-gradual-black",staticStyle:{position:"fixed",width:"100%",height:"100%"},style:{paddingTop:t.system.statusBarHeight+"px"}},[o("view",{staticClass:"cu-bar text-gold-light"},[o("view",{staticClass:"action",attrs:{eventid:"1cbf524e-0"},on:{tap:t.close}},[o("text",{staticClass:"cuIcon-close"})]),o("view",{staticClass:"content text-bold"},[t._v("手机号登录")])]),o("form",{staticClass:"text-gold-light"},[o("view",{staticClass:"cu-form-group",staticStyle:{"background-color":"rgba(0,0,0,0)",padding:"0 80rpx","margin-top":"20%"}},[o("view",{staticClass:"title"},[t._v("手机号")]),o("input",{directives:[{name:"model",rawName:"v-model:value",value:t.phone,expression:"phone",arg:"value"}],staticStyle:{color:"white"},attrs:{placeholder:"输入本人手机号",type:"number",eventid:"1cbf524e-1"},domProps:{value:t.phone},on:{input:function(e){e.target.composing||(t.phone=e.target.value)}}})]),o("view",{staticClass:"cu-form-group",staticStyle:{"background-color":"rgba(0,0,0,0)",padding:"0 80rpx"}},[o("view",{staticClass:"title"},[t._v("验证码")]),o("input",{directives:[{name:"model",rawName:"v-model:value",value:t.code,expression:"code",arg:"value"}],staticStyle:{color:"white"},attrs:{placeholder:"输入验证码",type:"number",name:"code",eventid:"1cbf524e-2"},domProps:{value:t.code},on:{input:function(e){e.target.composing||(t.code=e.target.value)}}}),o("button",{staticClass:"cu-btn text-gold-light",staticStyle:{"background-color":"rgba(0,0,0,0)",border:"solid 1px #e3c77f"},attrs:{eventid:"1cbf524e-3"},on:{tap:t.getcode}},[t._v(t._s(t.codeTime<=0?"获取":t.codeTime+"s"))])],1),o("view",{staticClass:"padding flex flex-direction"},[o("button",{staticClass:"cu-btn bg-gold-light margin-tb-sm lg",staticStyle:{color:"#222"},attrs:{eventid:"1cbf524e-4"},on:{tap:t.login}},[t._v("登录")])],1)])],1)},i=[];o.d(e,"a",function(){return n}),o.d(e,"b",function(){return i})},b207:function(t,e,o){"use strict";o("719a");var n=s(o("b0ce")),i=s(o("18ce"));function s(t){return t&&t.__esModule?t:{default:t}}Page((0,n.default)(i.default))},f370:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o("5ff1")["default"],i={data:function(){return{system:this.systemInfo(),nextPage:"",codeTime:0,phone:this.lastUserInfo().phone,code:"",token:"",openId:""}},onLoad:function(t){var e=t.page;e=e?decodeURIComponent(e):"/pages/my/my",this.nextPage=e},methods:{codeTimer:function(){0>=this.codeTimer?this.codeTime=0:(this.codeTime--,setTimeout(this.codeTimer,1e3))},getcode:function(){var e=this,o=/^[1][3,4,5,7,8,9][0-9]{9}$/;if(null!=this.phone&&this.phone.trim().length>0&&o.test(this.phone)){var n={};n.phone=this.phone,n.type="uni_phone_login",t.showLoading({title:"加载中",mask:!0}),this.postJson({path:"/user_phone_getcode.jsp",data:n,success:function(o){console.log(o),"ok"==o.data.status?(e.token=o.data.data.token,e.codeTime=60,e.codeTimer()):t.showToast({icon:"none",title:o.msg})},fail:function(e){t.showToast({icon:"none",title:"请您稍后再试"})},complete:function(){t.hideLoading()}})}else t.showToast({icon:"none",title:"请输入正确的手机号"})},login:function(){if(null!=this.token&&this.token.trim().length>0){var e=/^[1][3,4,5,7,8,9][0-9]{9}$/;if(null!=this.phone&&this.phone.trim().length>0&&e.test(this.phone))if(null!=this.code&&this.code.trim().length>0){var o=this,i={};i.phone=this.phone,i.token=this.token,i.valicode=this.code,t.showLoading({title:"加载中",mask:!0}),this.postJson({path:"/user_login_do.jsp",data:i,success:function(e){if("ok"==e.data.status){var i=e.data.user;t.setStorage({key:"user",data:JSON.stringify(i),success:function(){console.log("success"),o.conn.open({apiUrl:n.config.apiURL,user:i.uid,pwd:"111111",grant_type:"password",appKey:n.config.appkey}),t.$emit("logon",{msg:""}),t.navigateBack({})}})}else t.showToast({icon:"none",title:e.msg})},fail:function(e){t.showToast({icon:"none",title:"请您稍后再试"})},complete:function(e){t.hideLoading()}})}else t.showToast({icon:"none",title:"请输入验证码"});else t.showToast({icon:"none",title:"请输入正确的手机号"})}else t.showToast({icon:"none",title:"请先获取验证码"})},close:function(){t.$emit("login_cancel",{msg:"取消登录"}),t.navigateBack({})}}};e.default=i}).call(this,o("543d")["default"])}},[["b207","common/runtime","common/vendor"]]]);