(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/video/main"],{"02f6":function(t,i,e){"use strict";var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("view",{staticClass:"content",style:{height:t.clientHeight+"px"},attrs:{_hid:0}},[e("scroll-view",{staticClass:"scroll-content",style:{height:t.system.windowHeight+"px"},attrs:{"scroll-y":!0,"scroll-with-animation":!0,"upper-threshold":"-50","scroll-into-view":t.scrollToView,_hid:1,_batrs:"scroll-y,scroll-with-animation,scroll-into-view"},on:{scroll:t.scroll,scrolltolower:t.scrolltolower,scrolltoupper:t.refresh,touchstart:t.touchStart,touchmove:t.touchMove,touchend:t.touchEnd}},t._l(t.videolist,function(i,s,o){var a=void 0!==o?o:s;return e("view",{key:s,staticClass:"video-view",style:{height:t.system.windowHeight+"px"},attrs:{id:"view-"+s,_hid:2,_fid:a,_batrs:"id",_fk:"index"}},[t._ri(!(s!=t.currentPage),3,void 0!==o?o:s)?e("video",{style:{height:t.system.windowHeight-400*t.system.windowWidth/750+"px"},attrs:{id:"video-"+s,src:i.video_url,loop:"true",controls:!1,"show-progress":!1,"show-fullscreen-btn":!1,"show-play-btn":!1,"show-center-play-btn":!1,"enable-progress-gesture":!1,_hid:3,_fid:a,_batrs:"id,src,controls,show-progress,show-fullscreen-btn,show-play-btn,show-center-play-btn,enable-progress-gesture"},on:{tap:function(i){t.play(t.currentPage)}}},[t._ri(!!t.showCover,4,void 0!==o?o:s)?e("cover-image",{staticClass:"play_icon",style:{display:s!=t.playIndex?"block":"none"},attrs:{animation:t.animationData,src:"/static/img/play.png",_hid:4,_fid:a,_batrs:"animation",_cid:0}}):t._e()],1):t._e(),e("view",{staticClass:"goods padding",attrs:{_hid:1006,_fid:a}},[e("view",{staticClass:"title text-cut",attrs:{_hid:1007,_fid:a}},[t._v(t._s(i.goodstitle),1008,a)]),e("view",{staticClass:"flex",attrs:{_hid:1009,_fid:a}},[e("view",{staticClass:"flex-sub",attrs:{_hid:1010,_fid:a}},[e("view",{staticClass:"seller",attrs:{_hid:1011,_fid:a}},[t._v(t._s(i.goodsnick)+" | "+t._s(i.goodsarea),1012,a)]),e("view",{staticClass:"payinfo",attrs:{_hid:1013,_fid:a}},[e("text",{staticClass:"currency",attrs:{_hid:1014,_fid:a}},[]),e("text",{staticClass:"price",attrs:{_hid:1016,_fid:a}},[t._v(t._s(i.goodsprice),1017,a)]),e("text",{staticClass:"payernum",attrs:{_hid:1018,_fid:a}},[t._v(t._s(i.payer_num)+"人付款",1019,a)])])]),e("view",{staticClass:"action flex flex-sub justify-end align-start",attrs:{_hid:1020,_fid:a}},[e("view",{staticClass:"favor",attrs:{"data-index":s,_hid:1021,_fid:a,_batrs:"data-index"},on:{tap:t.like}},[e("image",{staticClass:"favor-img",attrs:{src:null!=i.favorId?"/static/img/favor.png":"/static/img/unlike.png",_hid:1022,_fid:a,_batrs:"src"}}),e("view",{staticClass:"favor-num",attrs:{_hid:1023,_fid:a}},[t._v(t._s(i.favorite_num),1024,a)])]),e("view",{staticClass:"share",attrs:{_hid:1025,_fid:a}},[e("image",{attrs:{src:"/static/img/share.png",_hid:1026,_fid:a}}),e("view",{attrs:{_hid:1027,_fid:a}},[t._v(t._s(i.share_num),1028,a)])]),e("button",{staticClass:"cu-btn round bg-blue",attrs:{_hid:1029,_fid:a},on:{tap:function(e){t.toPage("/pages/goods/goods?goodsId="+i.goodsid)}}},[])],1)]),e("view",{staticClass:"user flex justify-start align-end",attrs:{_hid:1031,_fid:a}},[e("image",{staticClass:"head-img",attrs:{src:i.head_img,_hid:1032,_fid:a,_batrs:"src"}}),e("view",{staticClass:"nickname",attrs:{_hid:1033,_fid:a}},[t._v(t._s(i.nick_name)+"  推荐",1034,a)]),e("view",{staticClass:"location flex justify-start align-end",attrs:{_hid:1035,_fid:a}},[e("view",{staticClass:"cuIcon-locationfill location-icon",attrs:{_hid:1036,_fid:a}}),e("view",{staticClass:"location-name",attrs:{_hid:1037,_fid:a}},[t._v(t._s(i.location_name),1038,a)])])]),e("view",{staticClass:"desc text-cut",attrs:{_hid:1039,_fid:a}},[t._v(t._s(i.video_desc),1040,a)])])])},2,t._self))],1)},o=[];e.d(i,"a",function(){return s}),e.d(i,"b",function(){return o})},"0659":function(t,i,e){"use strict";e.r(i);var s=e("846c"),o=e.n(s);for(var a in s)"default"!==a&&function(t){e.d(i,t,function(){return s[t]})}(a);i["default"]=o.a},"3d91":function(t,i,e){"use strict";var s=e("b451"),o=e.n(s);o.a},"846c":function(t,i,e){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var e={data:function(){return{system:this.systemInfo(),videolist:[],clientHeight:"0",currentPage:0,showPage:0,nextPage:0,touchdata:{can:!0,startY:0,endY:0,diff:0},playIndex:-1,scrollTop:0,scrollToView:"view-0",showCover:!0,animationData:{},playTime:0,scrollDetail:{deltaY:0},scrollFlag:!1,scrollStartTop:0,pageSize:20,pageIndex:0,scene:"",showTab:!0}},mounted:function(){var i=this;t.getSystemInfo({success:function(t){console.log(t.model),console.log(t.pixelRatio),console.log(t.windowWidth),console.log(t.windowHeight),console.log(t.language),console.log(t.version),console.log(t.platform),i.$data.clientHeight=t.windowHeight}})},watch:{},onLoad:function(t){var i=this;if(t.scene&&"default"!=t.scene){this.scene=t.scene;var e=t.scene;this.postJson({path:"/video_one.jsp",data:{videoId:e},success:function(t){if("ok"==t.data.status){var e=t.data.data;i.videolist=e.concat(i.videolist)}}})}this.postJson({path:"/video_main.jsp",data:{pageIndex:this.pageIndex,pageSize:this.pageSize,type:1},success:function(t){if(console.log(t.data),"ok"==t.data.status){i.pageIndex++;var e=t.data.data;i.videolist=i.videolist.concat(e)}}}),setInterval(this.listenScroll,200)},methods:{refresh:function(){var i=this;this.play(-1),t.showLoading({title:"加载中"}),this.videolist=[],this.pageIndex=0,this.postJson({path:"/video_main.jsp",data:{pageIndex:this.pageIndex,pageSize:this.pageSize,type:1},success:function(t){console.log(t.data),"ok"==t.data.status&&(i.pageIndex++,i.videolist=t.data.data,i.currentPage=0,i.scrollToView="view-0")},complete:function(){t.hideLoading()}})},scrolltolower:function(){var t=this;this.postJson({path:"/video_main.jsp",data:{pageIndex:this.pageIndex,pageSize:this.pageSize,type:1},success:function(i){if(console.log(i.data),"ok"==i.data.status){t.pageIndex++;var e=i.data.data;t.videolist=t.videolist.concat(e)}}})},play:function(i){var e="video-"+i,s="video-"+this.playIndex;if(-1==this.playIndex){this.playIndex=i;var o=t.createVideoContext(e);o&&(o.play(),this.playTime=(new Date).getTime())}else{var a=t.createVideoContext(s);if(a){a.pause();var l={playTime:this.playTime,endTime:(new Date).getTime(),videoId:this.videolist[this.playIndex].id,videoUid:this.videolist[this.playIndex].uid};this.browser(l),i!=this.playIndex?(this.playIndex=i,a=t.createVideoContext(e),a&&(a.play(),this.playTime=(new Date).getTime())):this.playIndex=-1}}},pause:function(i){var e="video-"+i,s=t.createVideoContext(e);if(s){s.pause();var o={playTime:this.playTime,endTime:(new Date).getTime(),videoId:this.videolist[i].id,videoUid:this.videolist[i].uid};this.browser(o)}this.playIndex=-1},browser:function(t){t.playTime<=0||(this.playTime=0,this.postJson({path:"/video_browser_do.jsp",data:t,success:function(t){}}))},listenScroll:function(){0!=this.scrollDetail.deltaY?(this.scrollFlag||(this.scrollStart(),this.scrollFlag=!0,this.scrollStartTop=this.scrollDetail.scrollTop),this.scrollDetail.deltaY=0):this.scrollFlag&&(this.scrollEnd(),this.scrollFlag=!1)},scrollStart:function(){},scrollEnd:function(){var t=this;if(!(this.autoScrollFlag-- >0)){var i=this.scrollDetail.scrollTop-this.scrollStartTop;console.log("clientHeight="+this.clientHeight+",scrollTop="+this.scrollDetail.scrollTop+",diff="+i),i<0?(console.log("this.touchdata.diff>0"),this.scrollDetail.scrollTop%this.clientHeight<this.clientHeight-10?(console.log("e.detail.scrollTop%this.clientHeight < this.clientHeight*3/4"),this.nextPage=Math.floor(this.scrollDetail.scrollTop/this.clientHeight)):this.nextPage=Math.floor(this.scrollDetail.scrollTop/this.clientHeight+1)):this.scrollDetail.scrollTop%this.clientHeight>=10?this.nextPage=Math.floor(this.scrollDetail.scrollTop/this.clientHeight+1):this.nextPage=Math.floor(this.scrollDetail.scrollTop/this.clientHeight),this.nextPage>=this.videolist.length&&(this.nextPage=this.videolist.length-1),this.nextPage<0&&(this.nextPage=0),this.scrollToView="view-"+this.nextPage,this.autoScrollFlag=1,setTimeout(function(){t.scrollToView=""},300),this.currentPage!=this.nextPage&&setTimeout(function(){t.currentPage=t.nextPage,t.play(t.currentPage),t.showCover=!0},700)}},scroll:function(t){var i=this;this.showCover=!1,this.scrollDetail=t.detail,setTimeout(function(){i.playIndex},100)},scrollTo:function(t){this.play(t)},scrollMove:function(t){},touchStart:function(t){var i=t.touches[0];this.touchdata.startY=i.pageY,console.log("y="+this.touchdata.startY),this.inDown=-1,this.outTop=-1,this.inTop=-1,this.outDown=-1,this.touchdata.diff=0},touchMove:function(t){var i=t.touches[0],e=i.pageY;this.touchdata.diff=e-this.touchdata.startY,console.log("currentPage="+this.currentPage+",nextPage="+this.nextPage+",diff="+this.touchdata.diff+",y="+e+",startY="+this.touchdata.startY)},touchEnd:function(t){var i=this,e=this.scrollDetail.scrollTop-this.scrollStartTop;if(this.scrollDetail.scrollTop&&!(e>-1&&e<1)){console.log("clientHeight="+this.clientHeight+",scrollTop="+this.scrollDetail.scrollTop+",diff="+e),e<0?(console.log("this.touchdata.diff>0"),this.scrollDetail.scrollTop%this.clientHeight<this.clientHeight-10?(console.log("e.detail.scrollTop%this.clientHeight < this.clientHeight*3/4"),this.nextPage=Math.floor(this.scrollDetail.scrollTop/this.clientHeight)):this.nextPage=Math.floor(this.scrollDetail.scrollTop/this.clientHeight+1)):this.scrollDetail.scrollTop%this.clientHeight>=10?this.nextPage=Math.floor(this.scrollDetail.scrollTop/this.clientHeight+1):this.nextPage=Math.floor(this.scrollDetail.scrollTop/this.clientHeight),this.nextPage>=this.videolist.length&&(this.nextPage=this.videolist.length-1),this.nextPage<0&&(this.nextPage=0);this.touchdata.diff=0,this.scrollToView="view-"+this.nextPage,this.autoScrollFlag=2,setTimeout(function(){i.scrollToView=""},500),this.currentPage!=this.nextPage&&setTimeout(function(){i.currentPage=i.nextPage,i.play(i.currentPage),i.showCover=!0},700)}},like:function(i){var e=i.currentTarget.dataset.index;if(this.getUserInfo()){var s=this.videolist[e],o=null==s.favorId;s.favorId=!!o||null,s.favorite_num=o?s.favorite_num+1:s.favorite_num-1,this.postJson({path:"/video_favorite_do.jsp",data:{videoId:s.id,videoUid:s.uid,isLike:o},success:function(t){}})}else t.showToast({icon:"none",title:"请先登录"})},touchCacel:function(t){this.touchEnd(t)},close:function(t){this.showTab=!1}}};i.default=e}).call(this,e("f266")["default"])},b451:function(t,i,e){},c568:function(t,i,e){"use strict";e("719a");var s=a(e("de5c")),o=a(e("3a53"));function a(t){return t&&t.__esModule?t:{default:t}}s.default.mpType="page";var l=new o.default(s.default);l.$mount()},de5c:function(t,i,e){"use strict";e.r(i);var s=e("02f6"),o=e("0659");for(var a in o)"default"!==a&&function(t){e.d(i,t,function(){return o[t]})}(a);e("3d91");var l=e("2877"),n=Object(l["a"])(o["default"],s["a"],s["b"],!1,null,null,null);i["default"]=n.exports}},[["c568","common/runtime","common/vendor"]]]);