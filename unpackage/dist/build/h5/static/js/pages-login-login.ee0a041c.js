(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-login-login"],{"0a63":function(t,e,n){"use strict";n.r(e);var i=n("cb43"),o=n.n(i);for(var s in i)"default"!==s&&function(t){n.d(e,t,function(){return i[t]})}(s);e["default"]=o.a},"18ce":function(t,e,n){"use strict";n.r(e);var i=n("6342"),o=n("0a63");for(var s in o)"default"!==s&&function(t){n.d(e,t,function(){return o[t]})}(s);var a=n("2877"),c=Object(a["a"])(o["default"],i["a"],i["b"],!1,null,"682a5cb8",null);e["default"]=c.exports},6342:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"bg-gradual-black",staticStyle:{position:"fixed",width:"100%",height:"100%"},style:{paddingTop:t.system.statusBarHeight+"px"}},[n("v-uni-view",{staticClass:"cu-bar text-gold-light"},[n("v-uni-view",{staticClass:"action",on:{click:function(e){e=t.$handleEvent(e),t.close(e)}}},[n("v-uni-text",{staticClass:"cuIcon-close"})],1),n("v-uni-view",{staticClass:"content text-bold"},[t._v("手机号登录")])],1),n("v-uni-form",{staticClass:"text-gold-light"},[n("v-uni-view",{staticClass:"cu-form-group",staticStyle:{"background-color":"rgba(0,0,0,0)",padding:"0 80upx","margin-top":"20%"}},[n("v-uni-view",{staticClass:"title"},[t._v("手机号")]),n("v-uni-input",{staticStyle:{color:"white"},attrs:{placeholder:"输入本人手机号",type:"number"},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}})],1),n("v-uni-view",{staticClass:"cu-form-group",staticStyle:{"background-color":"rgba(0,0,0,0)",padding:"0 80upx"}},[n("v-uni-view",{staticClass:"title"},[t._v("验证码")]),n("v-uni-input",{staticStyle:{color:"white"},attrs:{placeholder:"输入验证码",type:"number",name:"code"},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}}),n("v-uni-button",{staticClass:"cu-btn text-gold-light",staticStyle:{"background-color":"rgba(0,0,0,0)",border:"solid 1px #e3c77f"},on:{click:function(e){e=t.$handleEvent(e),t.getcode(e)}}},[t._v(t._s(t.codeTime<=0?"获取":t.codeTime+"s"))])],1),n("v-uni-view",{staticClass:"padding flex flex-direction"},[n("v-uni-button",{staticClass:"cu-btn bg-gold-light margin-tb-sm lg",staticStyle:{color:"#222"},on:{click:function(e){e=t.$handleEvent(e),t.login(e)}}},[t._v("登录")])],1)],1)],1)},o=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o})},cb43:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n("5ff1")["default"],o={data:function(){return{system:this.systemInfo(),nextPage:"",codeTime:0,phone:this.lastUserInfo().phone,code:"",token:"",openId:""}},onLoad:function(t){var e=t.page;e=e?decodeURIComponent(e):"/pages/my/my",this.nextPage=e},methods:{codeTimer:function(){0>=this.codeTimer?this.codeTime=0:(this.codeTime--,setTimeout(this.codeTimer,1e3))},getcode:function(){var t=this,e=/^[1][3,4,5,7,8,9][0-9]{9}$/;if(null!=this.phone&&this.phone.trim().length>0&&e.test(this.phone)){var n={};n.phone=this.phone,n.type="uni_phone_login",uni.showLoading({title:"加载中",mask:!0}),this.postJson({path:"/user_phone_getcode.jsp",data:n,success:function(e){console.log(e),"ok"==e.data.status?(t.token=e.data.data.token,t.codeTime=60,t.codeTimer()):uni.showToast({icon:"none",title:e.msg})},fail:function(t){uni.showToast({icon:"none",title:"请您稍后再试"})},complete:function(){uni.hideLoading()}})}else uni.showToast({icon:"none",title:"请输入正确的手机号"})},login:function(){if(null!=this.token&&this.token.trim().length>0){var t=/^[1][3,4,5,7,8,9][0-9]{9}$/;if(null!=this.phone&&this.phone.trim().length>0&&t.test(this.phone))if(null!=this.code&&this.code.trim().length>0){var e=this,n={};n.phone=this.phone,n.token=this.token,n.valicode=this.code,uni.showLoading({title:"加载中",mask:!0}),this.postJson({path:"/user_login_do.jsp",data:n,success:function(t){if("ok"==t.data.status){var n=t.data.user;uni.setStorage({key:"user",data:JSON.stringify(n),success:function(){console.log("success"),e.conn.open({apiUrl:i.config.apiURL,user:n.uid,pwd:"111111",grant_type:"password",appKey:i.config.appkey}),uni.$emit("logon",{msg:""}),uni.navigateBack({})}})}else uni.showToast({icon:"none",title:t.msg})},fail:function(t){uni.showToast({icon:"none",title:"请您稍后再试"})},complete:function(t){uni.hideLoading()}})}else uni.showToast({icon:"none",title:"请输入验证码"});else uni.showToast({icon:"none",title:"请输入正确的手机号"})}else uni.showToast({icon:"none",title:"请先获取验证码"})},close:function(){uni.$emit("login_cancel",{msg:"取消登录"}),uni.navigateBack({})}}};e.default=o}}]);