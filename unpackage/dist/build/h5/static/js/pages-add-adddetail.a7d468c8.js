(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-add-adddetail"],{"1e81":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"detail bg-gradual-pink",staticStyle:{position:"fixed",width:"100%",height:"100%"},style:{paddingTop:t.system.statusBarHeight+"px"}},[i("v-uni-view",{staticClass:"cu-bar ",staticStyle:{position:"fixed","z-index":"1",width:"100%"}},[i("v-uni-view",{staticClass:"action",on:{click:function(e){e=t.$handleEvent(e),t.back(e)}}},[i("v-uni-text",{staticClass:"cuIcon-back"})],1),i("v-uni-view",{staticClass:"content text-bold"},[t._v("商品详情")])],1),i("v-uni-scroll-view",{staticClass:"scroll",staticStyle:{width:"100%",height:"100%",padding:"100upx 0"},attrs:{"scroll-y":"true"}},[t._l(t.detaillist,function(e,n){return[i("v-uni-view",{key:n+"_0",staticClass:"flex flex-direction solid-bottom bg-white"},[i("v-uni-button",{staticClass:"cu-btn block line-grey lg",attrs:{"data-index":n},on:{click:function(e){e=t.$handleEvent(e),t.adddetail(e)}}},[i("v-uni-text",{staticClass:"cuIcon-add"}),t._v("添加图片或文本描述")],1)],1),"image"==e.type?i("v-uni-view",{key:n+"_1",staticClass:" flex flex-direction solid-bottom",staticStyle:{padding:"0 30upx","background-color":"white"}},[i("v-uni-image",{style:{height:(t.goodsImages["goodsimg"+n]?t.goodsImages["goodsimg"+n].height:t.goodsImgHeightInit)+"px"},attrs:{"data-index":n,src:e.value,id:"goodsimg"+n},on:{load:function(e){e=t.$handleEvent(e),t.goodsImageLoad(e)},click:function(e){e=t.$handleEvent(e),t.editImage(e)}}})],1):t._e(),"text"==e.type?i("v-uni-view",{key:n+"_2",staticClass:" flex flex-direction solid-bottom bg-white text-black",staticStyle:{padding:"0 30upx"}},[i("v-uni-textarea",{attrs:{"data-index":n,maxlength:"-1",placeholder:"请输入商品描述"},on:{focus:function(e){e=t.$handleEvent(e),t.editText(e)},blur:function(e){e=t.$handleEvent(e),t.editFinish(e)}}})],1):t._e()]}),i("v-uni-view",{staticClass:" flex flex-direction bg-white"},[i("v-uni-button",{staticClass:"cu-btn block line-grey lg",on:{click:function(e){e=t.$handleEvent(e),t.adddetail(e)}}},[i("v-uni-text",{staticClass:"cuIcon-add"}),t._v("添加图片或文本描述")],1)],1)],2),i("v-uni-view",{staticClass:"cu-bar bg-white tabbar border shop fixed ",staticStyle:{top:"unset",bottom:"0","z-index":"100"}},[i("v-uni-view",{staticClass:"flex-sub bg-pink submit",on:{click:function(e){e=t.$handleEvent(e),t.submit(e)}}},[t._v("保存")])],1)],1)},a=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return a})},"860c":function(t,e,i){var n=i("a4e4");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("5086255e",n,!0,{sourceMap:!1,shadowMode:!1})},a4e4:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".detail .scroll uni-textarea[data-v-023c3a1e]{font-size:%?34?%;height:%?200?%;width:100%;padding:%?20?% 0}.detail .scroll uni-image[data-v-023c3a1e]{width:100%}",""])},a8d5:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={data:function(){return{system:this.systemInfo(),goodsImages:{},goodsImgHeightInit:300,detaillist:[],editIndex:-1}},onLoad:function(t){var e=t.detail;e&&(this.detaillist=JSON.parse(e))},methods:{adddetail:function(t){var e=this,i=t.currentTarget.dataset.index;uni.showActionSheet({itemList:["图片","文本"],success:function(t){if(console.log("选中了第"+(t.tapIndex+1)+"个按钮"),0==t.tapIndex&&uni.chooseImage({count:1,sizeType:["compressed"],sourceType:["album"],success:function(t){console.log(JSON.stringify(t.tempFilePaths)),uni.showLoading({title:"加载中"}),e.loading=!0,uni.uploadFile({url:"https://www.dpsoft.top/upload.jsp",filePath:t.tempFilePaths[0],name:"file",success:function(t){console.log(t.data);var n=JSON.parse(t.data);if("ok"==n.status){var a=n.data,s="http://www.dpsoft.top/"+a,o={type:"image"};o.value=s,null!=i?e.detaillist.splice(i,0,o):e.detaillist.push(o)}},complete:function(){uni.hideLoading()}})}}),1==t.tapIndex){var n={type:"text",value:""};null!=i?e.detaillist.splice(i,0,n):e.detaillist.push(n)}},fail:function(t){console.log(t.errMsg)}})},editText:function(t){var e=this,i=t.currentTarget.dataset.index;this.editIndex!=i&&uni.showActionSheet({itemList:["编辑","删除"],success:function(t){console.log("选中了第"+(t.tapIndex+1)+"个按钮"),0==t.tapIndex&&(e.editIndex=i),1==t.tapIndex&&e.detaillist.splice(i,1)}})},editFinish:function(){this.editIndex=-1},editImage:function(t){var e=this,i=t.currentTarget.dataset.index;uni.showActionSheet({itemList:["删除"],success:function(t){console.log("选中了第"+(t.tapIndex+1)+"个按钮"),0==t.tapIndex&&e.detaillist.splice(i,1)}})},goodsImageLoad:function(t){var e=t.target.id,i=t.target.height,n=t.target.width,a=690*this.system.windowWidth/750,s=i*a/n;this.goodsImages[e]={width:a,height:s},this.goodsImgHeightInit=s},submit:function(){this.detaillist.length<=0?uni.showToast({icon:"none",title:"您还没有添加详情"}):(uni.setStorageSync("detail",JSON.stringify(this.detaillist)),uni.navigateBack({}))}}};e.default=n},ae82:function(t,e,i){"use strict";i.r(e);var n=i("a8d5"),a=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);e["default"]=a.a},b519:function(t,e,i){"use strict";var n=i("860c"),a=i.n(n);a.a},ce8c:function(t,e,i){"use strict";i.r(e);var n=i("1e81"),a=i("ae82");for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);i("b519");var o=i("2877"),d=Object(o["a"])(a["default"],n["a"],n["b"],!1,null,"023c3a1e",null);e["default"]=d.exports}}]);